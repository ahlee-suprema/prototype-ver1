<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ìú¥Í∞ÄÌòÑÌô©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>body { font-family: 'Inter', 'Noto Sans KR', sans-serif; }</style>
</head>
<body class="bg-slate-50 p-6">
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        // Ìú¥Í∞Ä ÏöîÏïΩ Ïπ¥Îìú
        const SummaryCards = ({ data }) => (
            <div className="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                {data.map((item, idx) => (
                    <div key={idx} className={`p-5 rounded-2xl ${item.bg}`}>
                        <div className="flex items-center justify-between mb-2">
                            <span className={`text-sm ${item.textColor}`}>{item.label}</span>
                            <span className="text-2xl">{item.icon}</span>
                        </div>
                        <div className={`text-2xl font-bold ${item.valueColor}`}>{item.value}</div>
                        <div className={`text-xs mt-1 ${item.textColor}`}>{item.sub}</div>
                    </div>
                ))}
            </div>
        );

        // Î∂ÄÏÑúÎ≥Ñ Ìú¥Í∞Ä ÏÇ¨Ïö©Î•†
        const DeptUsageChart = ({ data }) => (
            <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                <h3 className="text-lg font-semibold text-slate-800 mb-4">Î∂ÄÏÑúÎ≥Ñ Ìú¥Í∞Ä ÏÇ¨Ïö©Î•†</h3>
                <div className="space-y-4">
                    {data.map((dept, idx) => (
                        <div key={idx}>
                            <div className="flex justify-between text-sm mb-1">
                                <span className="text-slate-600">{dept.name}</span>
                                <div className="flex gap-3">
                                    <span className="text-slate-400">ÏÇ¨Ïö© {dept.used}Ïùº / {dept.total}Ïùº</span>
                                    <span className={`font-semibold ${dept.rate >= 70 ? 'text-green-600' : dept.rate >= 50 ? 'text-amber-600' : 'text-red-600'}`}>{dept.rate}%</span>
                                </div>
                            </div>
                            <div className="h-3 bg-slate-100 rounded-full overflow-hidden">
                                <div className={`h-full rounded-full ${dept.rate >= 70 ? 'bg-green-500' : dept.rate >= 50 ? 'bg-amber-500' : 'bg-red-500'}`} style={{ width: `${dept.rate}%` }} />
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        // ÏõîÎ≥Ñ Ìú¥Í∞Ä Ìå®ÌÑ¥
        const MonthlyPattern = ({ data }) => {
            const max = Math.max(...data.map(d => d.value));
            return (
                <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                    <h3 className="text-lg font-semibold text-slate-800 mb-4">ÏõîÎ≥Ñ Ìú¥Í∞Ä ÏÇ¨Ïö© Ìå®ÌÑ¥</h3>
                    <div className="flex items-end gap-2 h-36">
                        {data.map((month, idx) => (
                            <div key={idx} className="flex-1 flex flex-col items-center group">
                                <div className="relative w-full">
                                    <div className="w-full bg-purple-500 rounded-t hover:bg-purple-600 transition-all cursor-pointer" style={{ height: `${(month.value / max) * 100}%`, minHeight: '8px' }} />
                                    <div className="absolute -top-6 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">{month.value}Ïùº</div>
                                </div>
                                <span className="text-xs text-slate-500 mt-2">{month.label}</span>
                            </div>
                        ))}
                    </div>
                    <div className="mt-4 p-3 bg-purple-50 rounded-xl text-sm text-purple-700">
                        <span className="font-medium">Ïù∏ÏÇ¨Ïù¥Ìä∏:</span> 7~8Ïõî Ïó¨Î¶ÑÌú¥Í∞Ä ÏãúÏ¶åÏóê Ìú¥Í∞Ä ÏÇ¨Ïö©Ïù¥ ÏßëÏ§ëÎê©ÎãàÎã§. Ïó∞Îßê ÏÜåÏßÑÏùÑ ÏúÑÌï¥ 11~12Ïõî Ìú¥Í∞Ä ÏÇ¨Ïö©ÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.
                    </div>
                </div>
            );
        };

        // ÏûîÏó¨ Ìú¥Í∞Ä ÌòÑÌô© (Í∞úÏù∏Î≥Ñ)
        const RemainingLeave = ({ data }) => (
            <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                <div className="flex items-center justify-between mb-4">
                    <h3 className="text-lg font-semibold text-slate-800">ÏûîÏó¨ Ìú¥Í∞Ä ÌòÑÌô©</h3>
                    <span className="text-xs text-slate-500">Ïó∞Ï∞® Í∏∞Ï§Ä</span>
                </div>
                <div className="space-y-3 max-h-72 overflow-y-auto">
                    {data.map((person, idx) => (
                        <div key={idx} className="flex items-center justify-between p-3 bg-slate-50 rounded-xl hover:bg-slate-100 transition-colors">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 font-semibold">{person.name[0]}</div>
                                <div>
                                    <div className="font-medium text-slate-800">{person.name}</div>
                                    <div className="text-xs text-slate-500">{person.dept}</div>
                                </div>
                            </div>
                            <div className="flex items-center gap-4">
                                <div className="w-20 h-2 bg-slate-200 rounded-full overflow-hidden">
                                    <div className="h-full bg-purple-500 rounded-full" style={{ width: `${((person.total - person.remaining) / person.total) * 100}%` }} />
                                </div>
                                <div className="text-right w-20">
                                    <div className={`font-bold ${person.remaining <= 3 ? 'text-red-600' : 'text-slate-800'}`}>{person.remaining}Ïùº</div>
                                    <div className="text-xs text-slate-400">/ {person.total}Ïùº</div>
                                </div>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        // Ìú¥Í∞Ä Ïú†ÌòïÎ≥Ñ Î∂ÑÌè¨
        const LeaveTypeDistribution = ({ data }) => {
            const total = data.reduce((sum, d) => sum + d.value, 0);
            let cumulative = 0;

            return (
                <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                    <h3 className="text-lg font-semibold text-slate-800 mb-4">Ìú¥Í∞Ä Ïú†ÌòïÎ≥Ñ Î∂ÑÌè¨</h3>
                    <div className="flex items-center gap-6">
                        <div className="relative w-32 h-32">
                            <svg viewBox="0 0 100 100" className="transform -rotate-90">
                                {data.map((item, idx) => {
                                    const pct = (item.value / total) * 100;
                                    const offset = -cumulative;
                                    cumulative += pct;
                                    return <circle key={idx} cx="50" cy="50" r="40" fill="transparent" stroke={item.color} strokeWidth="12" strokeDasharray={`${pct} ${100-pct}`} strokeDashoffset={offset} />;
                                })}
                            </svg>
                            <div className="absolute inset-0 flex flex-col items-center justify-center">
                                <span className="text-xl font-bold text-slate-800">{total}</span>
                                <span className="text-xs text-slate-500">Ï¥ù ÏÇ¨Ïö©Ïùº</span>
                            </div>
                        </div>
                        <div className="flex-1 space-y-2">
                            {data.map((item, idx) => (
                                <div key={idx} className="flex items-center justify-between">
                                    <div className="flex items-center gap-2">
                                        <div className="w-3 h-3 rounded-full" style={{ backgroundColor: item.color }} />
                                        <span className="text-sm text-slate-600">{item.label}</span>
                                    </div>
                                    <span className="font-semibold text-slate-800">{item.value}Ïùº</span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const ReportLeave = () => {
            const summaryData = [
                { label: 'Ï†ÑÏ≤¥ Î∂ÄÏó¨ Ìú¥Í∞Ä', value: '1,800Ïùº', sub: 'Ï†Ñ ÏßÅÏõê Í∏∞Ï§Ä', icon: 'üìÖ', bg: 'bg-blue-50', textColor: 'text-blue-600', valueColor: 'text-blue-700' },
                { label: 'ÏÇ¨Ïö© Ìú¥Í∞Ä', value: '1,232Ïùº', sub: '68.4% ÏÜåÏßÑ', icon: '‚úàÔ∏è', bg: 'bg-purple-50', textColor: 'text-purple-600', valueColor: 'text-purple-700' },
                { label: 'ÏûîÏó¨ Ìú¥Í∞Ä', value: '568Ïùº', sub: 'Ïó∞Îßê ÏÜåÏßÑ Í∂åÏû•', icon: '‚è≥', bg: 'bg-amber-50', textColor: 'text-amber-600', valueColor: 'text-amber-700' },
                { label: 'Ïù¥Ïõî ÏòàÏ†ï', value: '120Ïùº', sub: 'ÎØ∏ÏÇ¨Ïö© Ïù¥Ïõî', icon: 'üì§', bg: 'bg-green-50', textColor: 'text-green-600', valueColor: 'text-green-700' },
            ];

            const deptData = [
                { name: 'Í∞úÎ∞ú1ÌåÄ', used: 78, total: 100, rate: 78 },
                { name: 'Í∞úÎ∞ú2ÌåÄ', used: 65, total: 88, rate: 74 },
                { name: 'ÎîîÏûêÏù∏ÌåÄ', used: 52, total: 60, rate: 87 },
                { name: 'ÎßàÏºÄÌåÖÌåÄ', used: 48, total: 80, rate: 60 },
                { name: 'ÏòÅÏóÖÌåÄ', used: 55, total: 112, rate: 49 },
                { name: 'Ïù∏ÏÇ¨ÌåÄ', used: 28, total: 40, rate: 70 },
            ];

            const monthlyData = [
                { label: '1Ïõî', value: 45 }, { label: '2Ïõî', value: 38 }, { label: '3Ïõî', value: 52 },
                { label: '4Ïõî', value: 48 }, { label: '5Ïõî', value: 85 }, { label: '6Ïõî', value: 62 },
                { label: '7Ïõî', value: 142 }, { label: '8Ïõî', value: 168 }, { label: '9Ïõî', value: 75 },
                { label: '10Ïõî', value: 58 }, { label: '11Ïõî', value: 95 }, { label: '12Ïõî', value: 125 },
            ];

            const remainingData = [
                { name: 'ÏµúÏ§ÄÌòÅ', dept: 'Í∞úÎ∞ú1ÌåÄ', total: 15, remaining: 2 },
                { name: 'ÍπÄÏ≤†Ïàò', dept: 'Í∞úÎ∞ú1ÌåÄ', total: 15, remaining: 5 },
                { name: 'Ïù¥ÏòÅÌù¨', dept: 'Í∞úÎ∞ú1ÌåÄ', total: 15, remaining: 7 },
                { name: 'Î∞ïÎØºÏàò', dept: 'Í∞úÎ∞ú2ÌåÄ', total: 15, remaining: 10 },
                { name: 'Ï†ïÏàòÏßÑ', dept: 'ÎîîÏûêÏù∏ÌåÄ', total: 15, remaining: 8 },
                { name: 'ÏÜ°ÏßÄÏùÄ', dept: 'Í∞úÎ∞ú2ÌåÄ', total: 15, remaining: 12 },
            ];

            const typeData = [
                { label: 'Ïó∞Ï∞®', value: 850, color: '#8b5cf6' },
                { label: 'Î∞òÏ∞®', value: 220, color: '#a78bfa' },
                { label: 'Î≥ëÍ∞Ä', value: 65, color: '#10b981' },
                { label: 'Í≤ΩÏ°∞ÏÇ¨', value: 45, color: '#f59e0b' },
                { label: 'Í≥µÍ∞Ä', value: 32, color: '#6366f1' },
                { label: 'Í∏∞ÌÉÄ', value: 20, color: '#94a3b8' },
            ];

            const handleExport = () => {
                const ws = XLSX.utils.aoa_to_sheet([
                    ['Ïù¥Î¶Ñ', 'Î∂ÄÏÑú', 'Ï¥ù Ìú¥Í∞Ä', 'ÏûîÏó¨ Ìú¥Í∞Ä', 'ÏÇ¨Ïö©Î•†'],
                    ...remainingData.map(d => [d.name, d.dept, d.total, d.remaining, Math.round(((d.total - d.remaining) / d.total) * 100) + '%'])
                ]);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Ìú¥Í∞ÄÌòÑÌô©');
                XLSX.writeFile(wb, `Ìú¥Í∞ÄÌòÑÌô©_${new Date().toISOString().split('T')[0]}.xlsx`);
            };

            return (
                <div className="max-w-7xl mx-auto">
                    <div className="flex items-center justify-between mb-6">
                        <div>
                            <h1 className="text-2xl font-bold text-slate-800">Ìú¥Í∞ÄÌòÑÌô©</h1>
                            <p className="text-slate-500 text-sm">Ìú¥Í∞Ä ÏÇ¨Ïö©Î•† Î∞è ÏûîÏó¨ ÌòÑÌô© Î∂ÑÏÑù</p>
                        </div>
                        <button onClick={handleExport} className="px-4 py-2 bg-green-600 text-white rounded-xl text-sm font-medium hover:bg-green-700">ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú</button>
                    </div>

                    {/* Summary Cards */}
                    <SummaryCards data={summaryData} />

                    {/* Main Grid */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <DeptUsageChart data={deptData} />
                        <LeaveTypeDistribution data={typeData} />
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <MonthlyPattern data={monthlyData} />
                        <RemainingLeave data={remainingData} />
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ReportLeave />);
    </script>
</body>
</html>
