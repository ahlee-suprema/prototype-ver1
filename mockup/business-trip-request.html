<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>외근/출장 신청 - Suprema T&A</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans KR', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe', 300: '#93c5fd',
                            400: '#60a5fa', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8',
                            800: '#1e40af', 900: '#1e3a8a'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', 'Noto Sans KR', sans-serif; }
        .toast { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;

        // Toast Context
        const ToastContext = createContext();
        const useToast = () => useContext(ToastContext);

        const ToastProvider = ({ children }) => {
            const [toasts, setToasts] = useState([]);

            const addToast = (message, type = 'success') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
                setTimeout(() => {
                    setToasts(prev => prev.filter(t => t.id !== id));
                }, 3000);
            };

            return (
                <ToastContext.Provider value={{ addToast }}>
                    {children}
                    <div className="fixed bottom-4 right-4 z-50 space-y-2">
                        {toasts.map(toast => (
                            <div
                                key={toast.id}
                                className={`toast px-4 py-3 rounded-xl shadow-lg flex items-center gap-3 ${
                                    toast.type === 'success' ? 'bg-green-500 text-white' :
                                    toast.type === 'error' ? 'bg-red-500 text-white' :
                                    toast.type === 'warning' ? 'bg-amber-500 text-white' :
                                    'bg-slate-800 text-white'
                                }`}
                            >
                                {toast.type === 'success' && (
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                                    </svg>
                                )}
                                {toast.message}
                            </div>
                        ))}
                    </div>
                </ToastContext.Provider>
            );
        };

        // Seoul Dong-level address data
        const seoulAddresses = [
            // Gangnam-gu
            '서울특별시 강남구 역삼동', '서울특별시 강남구 삼성동', '서울특별시 강남구 청담동',
            '서울특별시 강남구 논현동', '서울특별시 강남구 압구정동', '서울특별시 강남구 신사동',
            '서울특별시 강남구 대치동', '서울특별시 강남구 도곡동', '서울특별시 강남구 개포동',
            // Seocho-gu
            '서울특별시 서초구 서초동', '서울특별시 서초구 반포동', '서울특별시 서초구 양재동',
            '서울특별시 서초구 잠원동', '서울특별시 서초구 방배동', '서울특별시 서초구 우면동',
            // Songpa-gu
            '서울특별시 송파구 잠실동', '서울특별시 송파구 문정동', '서울특별시 송파구 가락동',
            '서울특별시 송파구 석촌동', '서울특별시 송파구 송파동', '서울특별시 송파구 마천동',
            // Gangdong-gu
            '서울특별시 강동구 천호동', '서울특별시 강동구 길동', '서울특별시 강동구 상일동',
            '서울특별시 강동구 둔촌동', '서울특별시 강동구 암사동', '서울특별시 강동구 성내동',
            // Jung-gu
            '서울특별시 중구 명동', '서울특별시 중구 을지로동', '서울특별시 중구 충무로',
            '서울특별시 중구 회현동', '서울특별시 중구 소공동', '서울특별시 중구 남대문로',
            // Jongno-gu
            '서울특별시 종로구 종로', '서울특별시 종로구 청진동', '서울특별시 종로구 사직동',
            '서울특별시 종로구 삼청동', '서울특별시 종로구 부암동', '서울특별시 종로구 평창동',
            // Yongsan-gu
            '서울특별시 용산구 이태원동', '서울특별시 용산구 한남동', '서울특별시 용산구 용산동',
            '서울특별시 용산구 이촌동', '서울특별시 용산구 서빙고동', '서울특별시 용산구 보광동',
            // Mapo-gu
            '서울특별시 마포구 공덕동', '서울특별시 마포구 아현동', '서울특별시 마포구 도화동',
            '서울특별시 마포구 용강동', '서울특별시 마포구 대흥동', '서울특별시 마포구 염리동',
        ];

        const BusinessTripRequestForm = () => {
            const toast = useToast();
            const [tripType, setTripType] = useState('외근'); // '외근' or '출장'
            const [startDate, setStartDate] = useState('2026-01-30');
            const [endDate, setEndDate] = useState('2026-01-30');
            const [startTime, setStartTime] = useState('09:00');
            const [endTime, setEndTime] = useState('18:00');
            const [location, setLocation] = useState('');
            const [locationSearch, setLocationSearch] = useState('');
            const [filteredAddresses, setFilteredAddresses] = useState([]);
            const [purpose, setPurpose] = useState('');
            const [description, setDescription] = useState('');
            const [calculatedDays, setCalculatedDays] = useState(1);
            const [showConfirmModal, setShowConfirmModal] = useState(false);

            // Monthly data
            const [monthlyData, setMonthlyData] = useState({
                month: '2026년 1월',
                trips: 5,
                days: 8,
            });

            // Calculate days
            useEffect(() => {
                if (startDate && endDate) {
                    const start = new Date(startDate);
                    const end = new Date(endDate);
                    const diffTime = Math.abs(end - start);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
                    setCalculatedDays(diffDays);
                }
            }, [startDate, endDate]);

            const handleSubmit = (e) => {
                e.preventDefault();

                if (!location.trim()) {
                    toast.addToast('위치를 입력해주세요', 'error');
                    return;
                }
                if (!purpose.trim()) {
                    toast.addToast('목적을 입력해주세요', 'error');
                    return;
                }

                setShowConfirmModal(true);
            };

            const confirmSubmit = () => {
                toast.addToast(`${tripType} 신청이 완료되었습니다`, 'success');
                setShowConfirmModal(false);

                // Reset form
                setTimeout(() => {
                    window.location.href = 'business-trip-management.html';
                }, 1500);
            };

            const handleLocationSearch = (value) => {
                setLocationSearch(value);
                if (value.length > 0) {
                    const filtered = seoulAddresses.filter(addr =>
                        addr.toLowerCase().includes(value.toLowerCase())
                    );
                    setFilteredAddresses(filtered.slice(0, 5)); // Show top 5 matches
                } else {
                    setFilteredAddresses([]);
                }
            };

            const selectAddress = (address) => {
                setLocation(address);
                setLocationSearch(address);
                setFilteredAddresses([]);
            };

            const getTripTypeColor = () => {
                return tripType === '출장' ? 'bg-purple-50 border-purple-200' : 'bg-blue-50 border-blue-200';
            };

            const getTripTypeBadgeColor = () => {
                return tripType === '출장'
                    ? 'bg-purple-100 text-purple-700 border-purple-200'
                    : 'bg-blue-100 text-blue-700 border-blue-200';
            };

            return (
                <div className="max-w-4xl mx-auto p-6">
                    {/* Header */}
                    <div className="flex items-center gap-4 mb-6">
                        <button
                            onClick={() => window.history.back()}
                            className="p-2 hover:bg-white rounded-xl transition-colors"
                        >
                            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                            </svg>
                        </button>
                        <div>
                            <h1 className="text-2xl font-bold text-slate-800">외근/출장 신청</h1>
                            <p className="text-slate-500">외근 또는 출장 일정을 신청합니다</p>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        {/* Left Column - Form */}
                        <div className="lg:col-span-2">
                            <form onSubmit={handleSubmit} className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                                {/* Trip Type Selection */}
                                <div className="mb-6">
                                    <label className="block text-sm font-semibold text-slate-700 mb-3">
                                        유형 선택 *
                                    </label>
                                    <div className="grid grid-cols-2 gap-3">
                                        <button
                                            type="button"
                                            onClick={() => setTripType('외근')}
                                            className={`p-4 rounded-xl border-2 transition-all ${
                                                tripType === '외근'
                                                    ? 'border-blue-500 bg-blue-50'
                                                    : 'border-slate-200 hover:border-blue-300'
                                            }`}
                                        >
                                            <div className="flex items-center justify-center gap-2 mb-2">
                                                <svg className="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                                </svg>
                                                <span className="font-semibold text-slate-800">외근</span>
                                            </div>
                                            <p className="text-xs text-slate-500">당일 외부 업무</p>
                                        </button>
                                        <button
                                            type="button"
                                            onClick={() => setTripType('출장')}
                                            className={`p-4 rounded-xl border-2 transition-all ${
                                                tripType === '출장'
                                                    ? 'border-purple-500 bg-purple-50'
                                                    : 'border-slate-200 hover:border-purple-300'
                                            }`}
                                        >
                                            <div className="flex items-center justify-center gap-2 mb-2">
                                                <svg className="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                </svg>
                                                <span className="font-semibold text-slate-800">출장</span>
                                            </div>
                                            <p className="text-xs text-slate-500">장기 외부 업무</p>
                                        </button>
                                    </div>
                                </div>

                                {/* Date Selection */}
                                <div className="mb-6">
                                    <label className="block text-sm font-semibold text-slate-700 mb-3">
                                        기간 *
                                    </label>
                                    <div className="grid grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <label className="block text-xs text-slate-600 mb-2">시작일</label>
                                            <input
                                                type="date"
                                                value={startDate}
                                                onChange={(e) => setStartDate(e.target.value)}
                                                className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"
                                                required
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-xs text-slate-600 mb-2">종료일</label>
                                            <input
                                                type="date"
                                                value={endDate}
                                                onChange={(e) => setEndDate(e.target.value)}
                                                min={startDate}
                                                className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-xs text-slate-600 mb-2">시작 시간</label>
                                            <input
                                                type="time"
                                                value={startTime}
                                                onChange={(e) => setStartTime(e.target.value)}
                                                className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"
                                                required
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-xs text-slate-600 mb-2">종료 시간</label>
                                            <input
                                                type="time"
                                                value={endTime}
                                                onChange={(e) => setEndTime(e.target.value)}
                                                className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="mt-2 text-sm text-slate-500">
                                        총 <span className="font-semibold text-green-600">{calculatedDays}일</span>
                                    </div>
                                </div>

                                {/* Location */}
                                <div className="mb-6 relative">
                                    <label className="block text-sm font-semibold text-slate-700 mb-2">
                                        위치 *
                                    </label>
                                    <input
                                        type="text"
                                        value={locationSearch}
                                        onChange={(e) => handleLocationSearch(e.target.value)}
                                        placeholder="서울시 동 단위로 검색 (예: 역삼동, 강남구)"
                                        className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"
                                        required
                                    />
                                    {/* Address suggestions dropdown */}
                                    {filteredAddresses.length > 0 && (
                                        <div className="absolute z-10 w-full mt-1 bg-white border border-slate-200 rounded-xl shadow-lg max-h-48 overflow-y-auto">
                                            {filteredAddresses.map((addr, idx) => (
                                                <div
                                                    key={idx}
                                                    onClick={() => selectAddress(addr)}
                                                    className="px-4 py-3 hover:bg-green-50 cursor-pointer text-sm text-slate-700 border-b border-slate-100 last:border-b-0"
                                                >
                                                    {addr}
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>

                                {/* Purpose */}
                                <div className="mb-6">
                                    <label className="block text-sm font-semibold text-slate-700 mb-2">
                                        목적 *
                                    </label>
                                    <input
                                        type="text"
                                        value={purpose}
                                        onChange={(e) => setPurpose(e.target.value)}
                                        placeholder="예: 고객사 미팅 / 시스템 점검 / 교육"
                                        className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"
                                        required
                                    />
                                </div>

                                {/* Description */}
                                <div className="mb-6">
                                    <label className="block text-sm font-semibold text-slate-700 mb-2">
                                        상세 내용
                                    </label>
                                    <textarea
                                        value={description}
                                        onChange={(e) => setDescription(e.target.value)}
                                        placeholder="추가 설명이 필요한 경우 작성해주세요"
                                        rows={4}
                                        className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 resize-none"
                                    />
                                </div>

                                {/* Submit Button */}
                                <div className="flex gap-3">
                                    <button
                                        type="button"
                                        onClick={() => window.history.back()}
                                        className="flex-1 py-3 px-6 border-2 border-slate-200 text-slate-600 rounded-xl font-semibold hover:bg-slate-50 transition-colors"
                                    >
                                        취소
                                    </button>
                                    <button
                                        type="submit"
                                        className="flex-1 py-3 px-6 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700 transition-colors shadow-lg shadow-green-500/30"
                                    >
                                        신청하기
                                    </button>
                                </div>
                            </form>
                        </div>

                        {/* Right Column - Summary */}
                        <div className="space-y-6">
                            {/* Current Month Status */}
                            <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                                <h3 className="text-sm font-semibold text-slate-700 mb-4">이번달 현황</h3>
                                <div className="space-y-4">
                                    <div>
                                        <div className="text-xs text-slate-500 mb-1">외근/출장 횟수</div>
                                        <div className="text-2xl font-bold text-slate-800">{monthlyData.trips}건</div>
                                    </div>
                                    <div>
                                        <div className="text-xs text-slate-500 mb-1">총 기간</div>
                                        <div className="text-2xl font-bold text-green-600">{monthlyData.days}일</div>
                                    </div>
                                </div>
                            </div>

                            {/* Request Summary */}
                            <div className={`rounded-2xl p-6 border-2 ${getTripTypeColor()}`}>
                                <h3 className="text-sm font-semibold text-slate-700 mb-4">신청 요약</h3>
                                <div className="space-y-3">
                                    <div className="flex justify-between items-center">
                                        <span className="text-xs text-slate-600">유형</span>
                                        <span className={`px-3 py-1 rounded-lg text-xs font-medium border ${getTripTypeBadgeColor()}`}>
                                            {tripType}
                                        </span>
                                    </div>
                                    <div className="flex justify-between items-center">
                                        <span className="text-xs text-slate-600">기간</span>
                                        <span className="text-sm font-semibold text-slate-800">{calculatedDays}일</span>
                                    </div>
                                    <div className="flex justify-between items-center">
                                        <span className="text-xs text-slate-600">시작</span>
                                        <span className="text-sm font-medium text-slate-700">{startDate} {startTime}</span>
                                    </div>
                                    <div className="flex justify-between items-center">
                                        <span className="text-xs text-slate-600">종료</span>
                                        <span className="text-sm font-medium text-slate-700">{endDate} {endTime}</span>
                                    </div>
                                    {location && (
                                        <div className="pt-3 border-t border-slate-200">
                                            <div className="text-xs text-slate-600 mb-1">위치</div>
                                            <div className="text-sm font-medium text-slate-800">{location}</div>
                                        </div>
                                    )}
                                    {purpose && (
                                        <div className="pt-3 border-t border-slate-200">
                                            <div className="text-xs text-slate-600 mb-1">목적</div>
                                            <div className="text-sm font-medium text-slate-800">{purpose}</div>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* Info Box */}
                            <div className="bg-blue-50 rounded-2xl p-4 border border-blue-100">
                                <div className="flex gap-2">
                                    <svg className="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <div className="text-xs text-blue-700">
                                        <p className="font-semibold mb-1">안내사항</p>
                                        <ul className="space-y-1">
                                            <li>• 외근/출장 신청은 사전에 승인이 필요합니다</li>
                                            <li>• 위치와 목적을 명확히 기재해주세요</li>
                                            <li>• 교통비 정산이 필요한 경우 영수증을 보관해주세요</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Confirmation Modal */}
                    {showConfirmModal && (
                        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6">
                                <h3 className="text-xl font-bold text-slate-800 mb-4">신청 확인</h3>
                                <div className="space-y-3 mb-6">
                                    <div className="flex justify-between">
                                        <span className="text-slate-600">유형</span>
                                        <span className="font-semibold text-slate-800">{tripType}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-slate-600">날짜</span>
                                        <span className="font-semibold text-slate-800">{startDate} ~ {endDate} ({calculatedDays}일)</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-slate-600">시간</span>
                                        <span className="font-semibold text-slate-800">{startTime} ~ {endTime}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-slate-600">위치</span>
                                        <span className="font-semibold text-slate-800">{location}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-slate-600">목적</span>
                                        <span className="font-semibold text-slate-800">{purpose}</span>
                                    </div>
                                </div>
                                <div className="flex gap-3">
                                    <button
                                        onClick={() => setShowConfirmModal(false)}
                                        className="flex-1 py-3 border-2 border-slate-200 text-slate-600 rounded-xl font-semibold hover:bg-slate-50"
                                    >
                                        취소
                                    </button>
                                    <button
                                        onClick={confirmSubmit}
                                        className="flex-1 py-3 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700"
                                    >
                                        확인
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <ToastProvider>
                <BusinessTripRequestForm />
            </ToastProvider>
        );
    </script>
</body>
</html>
